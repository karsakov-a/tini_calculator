# TINI Calculator

## Описание проекта
TINI Calculator — это автономное настольное приложение для врачей и клиницистов, предназначенное для быстрого расчёта тромбо-воспалительного индекса (TINI) — прогностического показателя, оценивающего риск неблагоприятного исхода у пациентов с тяжёлыми инфекционными и воспалительными состояниями.

Формула расчёта:
(d_dimer * interleukins) / denominator


Программа автоматически интерпретирует результат:
Менее 100 000 — низкий риск смерти
100 001 – 500 000 — умеренный риск
Более 500 000 — высокий риск смерти (>90% в валидационных когортах)
При наличии данных КТ (>70% поражения лёгких) и TINI > 500 000 система выводит дополнительное предупреждение о чрезвычайно высоком риске.

## Описание работы с ПО
1. Заполните обязательные поля (отмечены звёздочкой *):
  - D-димер (нг/мл)
  - Интерлейкины, ИЛ-6 (пг/мл)
  - Лимфоциты (×10⁹/л)
2. Опционально укажите:
  - ФИО пациента
  - Пол
  - Дату рождения и дату исследования (программа автоматически рассчитает возраст)
  - Объём поражения лёгких по данным МСКТ (%)
3. Расчёт выполняется вручную — нажмите «ВЫПОЛНИТЬ РАСЧЁТ», когда все обязательные поля заполнены.
4. После расчёта станут доступны действия:
  - Сбросить — очистить форму
  - Скопировать отчёт — сохранить текстовый отчёт в буфер обмена
  - Сохранить в PDF — экспортировать отчёт в PDF-файл
5. Валидация:
  - D-димер и ИЛ-6: от 0 до 5000
  - Лимфоциты: от 0.0 до 10.0
  - Объём поражения КТ: целое число от 0 до 100 (ввод значений >100 невозможен)
  - Дата исследования не может быть позже текущей даты
  - Дата рождения не может быть позже даты исследования

## Установка
1. Клонирование репозитория:
```
git clone https://github.com/your-repo/tini_calculator.git 
cd tini_calculator
```
При необходимости создайте .env файл в корне проекта со следующим содержимым:
```
DEBUG=False
```

2. Создайте и активируйте виртуальное окружение:
```
py -m venv venv
source env/bin/activate
python -m pip install --upgrade pip
```

3. Установить зависимости из файла requirements.txt:
```
pip install -r requirements.txt
```

4. Соберите приложение:
```
pyinstaller --onefile --windowed --name "CITI Calculator" --icon=icon.ico main.py
```
`--onefile` Упаковать всё в один .exe-файл
`--windowed` Скрыть консольное окно (важно для GUI-приложений)
`--name "CITI Calculator"` Имя выходного исполняемого файла
`--clean` Очистить кэш перед сборкой (рекомендуется для стабильности)

Готовый .exe-файл будет находиться в папке dist/

Отладка выпонеяется через пакет watchdog. Для запуска выполнить
```
watchmedo auto-restart --directory=. --pattern="*.py" --recursive -- venv/Scripts/python main.py
```
Будет запущена демо версия программы с текущим состоянием кода. Установлено, что при включенном режиме дебага программа запускается на экране со смещением (550, 100)
auto-restart — подкоманда: автоматически перезапускать указанный процесс при изменении отслеживаемых файлов

`--directory=.` — отслеживать изменения в текущей директории (.)
`--pattern="*.py"` — перезапускать только при изменении файлов, соответствующих шаблону *.py (все Python-файлы)
`--recursive` — отслеживать изменения рекурсивно во всех поддиректориях текущей папки
`--` — разделитель: всё, что после, интерпретируется как команда для запуска (а не как аргументы watchmedo)
`venv/Scripts/python main.py` — команда, которая будет перезапускаться: запуск main.py с помощью интерпретатора из виртуального окружения

## Стек технологий
Язык программирования: Python 3.9+
GUI-фреймворк: PySide6 (официальная LGPL-совместимая обёртка над Qt6)
Упаковка: PyInstaller (для сборки в один .exe-файл)
Управление конфигурацией: python-dotenv (файл .env для режима отладки)
Экспорт отчётов: встроенный QPrinter (PDF без внешних библиотек)
Логирование: стандартный модуль logging (логи сохраняются в logs/YYYY-MM-DD.log)


## Авторство
Автор: @proger220
Контакты: proger220@sumo.com